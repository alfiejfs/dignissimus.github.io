<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Efficiently calculating the Fibonacci sequence using primitive recursion</title>
        <link rel="stylesheet" href="../assets/fonts.css">
        <link rel="stylesheet" href="../assets/graphite.css">
        <link rel="stylesheet" href="../assets/pygments.css">
        

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>

       <script src="https://unpkg.com/function-plot/dist/function-plot.js"></script>

        
        
    </head>
    <body class="node-computer-science-the-fibonacci-sequence-and-primitive-recursion node-computer-science node">
        <header class="masthead">
            <h1><a href="../index.html">Sam's blog</a></h1>
            
                <p class="tagline">Assorted ideas, thoughts and considerations</p>
            
            
            <nav class="menu">
                <input id="menu-check" type="checkbox"/>
                <label id="menu-label" for="menu-check" class="unselectable">
                    <span class="icon close-icon">✕</span>
                    <span class="icon open-icon">☰</span>
                    <span class="text">Menu</span>
                </label>
                <ul>
<li><a href="../index.html">Home</a></li>
<li><a href="../programming.html">Programming</a></li>
<li><a href="../economics.html">Economics</a></li>
<li><a href="../computer-science.html">Computer Science</a></li>
</ul>
            </nav>
        </header>
        <article class="main">
            <header class="title">
                <h1>Efficiently calculating the Fibonacci sequence using primitive recursion</h1>
                
                <hr>
            </header>
            <p>
Primitive recursive functions [1] are defined in terms of the initial functions. The initial functions are by definition primitive and include
</p>
<ul>
<li>
The nullary function \(n(x) = 0\)
</li>
<li>
The successor function \(s(x) = x + 1\)
</li>
<li>
Projection \(u^n_i(x_1, \dots, x_n) = x_i\)
</li>
</ul>
<p>
Further primitive recursive functions can be created via composition \(f \circ g\) and via primitive recursion.
</p>
<p>
For some total function \(g\) and constant \(k\), \(h\) is said to have been obtained from \(g\) via primitie recursion if
</p>
<p>
$$
\begin{align}
h(0) &amp;= k\\
h(t + 1) &amp;= g(t, h(t))\\
\end{align}
$$
</p>
<p>
The smallest class of functions including the initial functions and is closed under primitve recursion defines the primitive recursive functions.
</p>
<p>
The Fibonacci sequence can be defined as follows
</p>
<pre class="lang-haskell pygments" data-lang="haskell">
<span class="nf">fib</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="nf">fib</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="nf">fib</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fib</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fib</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
</pre>
<p>
This isn't defined in terms of primitive recursion. The following definition, for example, does not make use primitive recursion
</p>
<p>
$$
\begin{align}
\mathtt{fib}(0) &amp;= 0 \\
\mathtt{fib}(0) &amp;= 1 \\
\mathtt{fib}(0) &amp;= \mathtt{fib}(n - 1) + \mathtt{fib}(n - 2)\\
\end{align}
$$
</p>
<p>
One thing to note is that this implementation is inefficient.
</p>
<p>
The <code>fib</code> function contains two recursive calls. If T(n) denotes the runtime of the <code>fib</code> function for a value, \(n\), then we now have
</p>
<p>
$$T(n) = T(n-1) + T(n-2)$$
</p>
<p>
This is a homogenous linear recurrence relation and can be solved in the standard way
</p>
<p>
Observing that this defines recurrence relation also defines the Fibonacci sequence funnily implies that the runtime, \(T(n)\), of our function to calculate the value of the Fibonacci sequence at index \(n\) runs in \(O\left(F(n)\right)\) time where \(F\) refers to the value of the Fibonacci sequence at index \(n\).
</p>
<p>
However, the Fibonacci function is in fact primitive recursive. The primitive recursive solution comes about by noticing that every term of the Fibonacci sequence can be computed by only knowing the previous two values of the sequence.
</p>
<p>
So, define \(F'(n)\) to be \(\left&lt; F(n), F(n+1) \right&gt; \). We now have
</p>
<p>
$$
\begin{align}
F'(0) &amp;= \left&lt;0, 1\right&gt; \\
F'(1) &amp;= \left&lt;1, 1\right&gt; \\
\end{align}
$$
</p>
<p>
Since
</p>
<p>
$$
\begin{align}
F'(n) &amp;= \left&lt; F(n), F(n+1)\right&gt; \\
&amp;= \left&lt; F(n-1) + F(n - 2), F(n) + F(n - 1) \right&gt; \\
&amp;= \left&lt; F'(n-1)_2, F'(n-1)_1 + F(n-1)_2 \right&gt; \\
\end{align}
$$
</p>
<p>
This is primitive recursive
</p>
<p>
$$
\begin{align}
F(n) &amp;= F'(n)_1 \\
\end{align}
$$
</p>
<p>
The primitive recursive functions are closed under composition and ordered pairs can be represented using Gödel numbering so the Fibonacci sequence is primitive recursive and the Fibonacci sequence can be calculated in \(O(n)\) time.
</p>
<pre class="lang-haskell pygments" data-lang="haskell">
<span class="nf">fib&#39;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nf">fib&#39;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="nf">fib&#39;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="p">(</span><span class="n">right</span><span class="p">,</span><span class="w"> </span><span class="n">left</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">right</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="kr">where</span><span class="w"></span>
<span class="w">    </span><span class="n">left</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fst</span><span class="w"> </span><span class="n">values</span><span class="w"></span>
<span class="w">    </span><span class="n">right</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">snd</span><span class="w"> </span><span class="n">values</span><span class="w"></span>
<span class="w">    </span><span class="n">values</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fib&#39;</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"></span>

<span class="nf">fib</span><span class="w"> </span><span class="ow">=</span><span class="w"> </span><span class="n">fst</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="n">fib&#39;</span><span class="w"></span>
</pre>
<ol>
<li>
<i>Computability, Complexity and Languages</i>, Davis, Sigal, Weyuker
</li>
</ol>
        </article>
        
    </body>
</html>
