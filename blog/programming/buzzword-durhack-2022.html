<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Buzzword</title>
        <link rel="stylesheet" href="../assets/fonts.css">
        <link rel="stylesheet" href="../assets/graphite.css">
        <link rel="stylesheet" href="../assets/pygments.css">
        

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>
        <script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script>

       <script src="https://unpkg.com/function-plot/dist/function-plot.js"></script>

        
        
    </head>
    <body class="node-programming-buzzword-durhack-2022 node-programming node">
        <header class="masthead">
            <h1><a href="../index.html">Sam's blog</a></h1>
            
                <p class="tagline">Assorted ideas, thoughts and considerations</p>
            
            
            <nav class="menu">
                <input id="menu-check" type="checkbox"/>
                <label id="menu-label" for="menu-check" class="unselectable">
                    <span class="icon close-icon">✕</span>
                    <span class="icon open-icon">☰</span>
                    <span class="text">Menu</span>
                </label>
                <ul>
<li><a href="../index.html">Home</a></li>
<li><a href="../programming.html">Programming</a></li>
<li><a href="../economics.html">Economics</a></li>
<li><a href="../computer-science.html">Computer Science</a></li>
<li><a href="../scratchpad.html">Scratchpad</a></li>
</ul>
            </nav>
        </header>
        <article class="main">
            <header class="title">
                <h1>Buzzword</h1>
                
                    <p class="subtitle">The timeline of my experience at Durhack</p>
                
                <hr>
            </header>
            <h1>10:39 - The beginning</h1>
<p>
Today I'm taking part in <a href="https://durhack.com/">Durhack</a>, the <a href="https://durham.ac.uk/">Durham University</a> Hackathon and I'm determined to make the dumbest project at the hackathon. My vague idea is a project with the name of <i>Buzzword</i>. It's a distributed-first, scalable programming language with built-in automatic differentiation for Machine Learning on the Blockchain. Yup.
</p>
<h1> 10:53 - The group that uses Rust </h1>
<p>
I have just met a group being led by a Rust programmer, the rest of the group is new to Rust. I inquire about this and remark that it takes a <i>lifetime</i> (pun-intended) to understand the Rust borrow-checker.
<h1> 10:57 - Doubly linked lsits </h1>
Today I learned about Doubly Linked Lists in Rust. Gnarly.
</p>
<pre class="lang-rust pygments" data-lang="rust">
<span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">rc</span>::<span class="n">Rc</span><span class="p">;</span><span class="w"></span>
<span class="k">use</span><span class="w"> </span><span class="n">std</span>::<span class="n">cell</span>::<span class="n">RefCell</span><span class="p">;</span><span class="w"></span>

<span class="k">pub</span><span class="w"> </span><span class="k">struct</span> <span class="nc">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">head</span>: <span class="nc">Link</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">tail</span>: <span class="nc">Link</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">type</span> <span class="nc">Link</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Option</span><span class="o">&lt;</span><span class="n">Rc</span><span class="o">&lt;</span><span class="n">RefCell</span><span class="o">&lt;</span><span class="n">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;&gt;&gt;</span><span class="p">;</span><span class="w"></span>

<span class="k">struct</span> <span class="nc">Node</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">elem</span>: <span class="nc">T</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">next</span>: <span class="nc">Link</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">prev</span>: <span class="nc">Link</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre>
<h1> 11:04 - A profound realisation </h1>
<p>
I realise that if I spend my entire time writing about Durhack, I will not have time to do any programming.
</p>
<h1> 11:06 - The introductory talk commences </h1>
<h1> 12:03 - A smart idea</h1>
<p>
I decide to stop writing and start programming.
</p>
<h1> 12:04 - Scratch that</h1>
<p>
I realise that I need to program in Solidity, but I do not know how to program in solidity. <i>But</i> I have 24 hours to work this out, I think.
<h1> 12:05 - Intermission </h1>
I will see if I can find any food and after that I will start programming, <i>I promise</i>.
<h1> 12:08 - Disappointment </h1>
I have been informed that the Subway order has been delayed. I will begin programming albeit hungry and a bit sad.
<h1> 12:18 - I need a plan </h1>
I think the most important part of this project is getting machine learning done on the blockchain. So I've made the decision to postpone the language implementation until later.
</p>
<p>
I started defining the necessary data types to build an API for Neural Networks but I'm wondering if I even need to do this. My idea is that I can start with classical Machine Learning techniques and potentially add Neural Networks if I have time. My only concern with Neural networks is the backpropogation step, I want to keep my project simple so I make a mistake and spend more time debugging.
</p>
<p>
I'll keep the API in a separate file but I'll focus my efforts on getting a proof of concept first.
</p>
<h1> 12:33 - Another realisation</h1>
<p>
I am learning Solidity at the same time as building a relatively non-trivial project in it. I am currently working out how to read an array of integers from a string.
</p>
<h1> 12:53 - Progress?? </h1>
<p>
I am learning a lot about solidity and I think I've just read a list of integers from a string??
My code compiles, which I did not expect.
</p>
<h1> 12:57 - ??? </h1>
<p>
I feel like a Boomer. I think I just deployed some code to the blockchain?
</p>
<h1> 12:59 - ????? </h1>
<p>
I ran my code and it did not error?
</p>
<h1> 13:00 - Progress! </h1>
<p>
I can read strings into integer arrays and store them on the blockchain! It only took 27 minutes, 66 lines of code and countless lookups to the solidity reference document.
</p>
<pre class="lang-solidity pygments" data-lang="solidity">
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.7</span><span class="p">;</span><span class="w"></span>

<span class="k">contract</span><span class="w"> </span><span class="ni">Buzzword</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span>bytes1<span class="w"> </span><span class="kt">constant</span><span class="w"> </span>ZERO<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>bytes1<span class="w"> </span><span class="kt">constant</span><span class="w"> </span>NINE<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;9&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span>xs<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span>ys<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span>work<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">loadData</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>xstring<span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>ystring<span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">payable</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>xbytes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">bytes</span><span class="p">(</span>xstring<span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>ybytes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">bytes</span><span class="p">(</span>ystring<span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Work on the assumption that there is at least one item in the arrays</span>
<span class="w">        </span>xs<span class="w"> </span><span class="o">=</span><span class="w"> </span>readIntegerArray<span class="p">(</span>xbytes<span class="p">);</span><span class="w"></span>
<span class="w">        </span>ys<span class="w"> </span><span class="o">=</span><span class="w"> </span>readIntegerArray<span class="p">(</span>ybytes<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">testXsContainsData</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>xs<span class="p">[</span><span class="m m-Decimal">0</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">readIntegerArray</span><span class="p">(</span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>bArray<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="kt">memory</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span>work<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[](</span><span class="m m-Decimal">0</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Work out how many numbers there are</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">numIntegers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>index<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>bArray<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>index<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>index<span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>numIntegers<span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">// The beginning of the number begins at</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">bArrayIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>index<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>numIntegers<span class="p">;</span><span class="w"> </span>index<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Read the sign</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="nv">sign</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>bArrayIndex<span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;+&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>sign<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="kt">else</span><span class="w"> </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>bArrayIndex<span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>sign<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="kt">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="kt">require</span><span class="p">(</span><span class="kt">false</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Increment the string index</span>
<span class="w">            </span>bArrayIndex<span class="o">++</span><span class="p">;</span><span class="w"></span>


<span class="w">            </span><span class="kt">uint</span><span class="w"> </span><span class="nv">number</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Read numbers until the termination character</span>
<span class="w">            </span><span class="kt">while</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>bArrayIndex<span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>number<span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="m m-Decimal">10</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span>bytes1<span class="w"> </span>digitByte<span class="w"> </span><span class="o">=</span><span class="w"> </span>bArray<span class="p">[</span>bArrayIndex<span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="kt">require</span><span class="p">(</span>ZERO<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>digitByte<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"> </span>digitByte<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>NINE<span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="kt">uint8</span><span class="w"> </span><span class="nv">digitValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">uint8</span><span class="p">(</span>digitByte<span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="kt">uint8</span><span class="p">(</span>ZERO<span class="p">);</span><span class="w"></span>
<span class="w">                </span>number<span class="w"> </span><span class="o">+=</span><span class="w"> </span>digitValue<span class="p">;</span><span class="w"></span>
<span class="w">                </span>bArrayIndex<span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span>work<span class="p">.</span>push<span class="p">(</span><span class="kt">int</span><span class="p">(</span>number<span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>sign<span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kt">return</span><span class="w"> </span>work<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre>
<p>
I am not looking forward to implementing any sort of machine learning.
</p>
<h1> 13:06 - Problems </h1>
<p>
I will probably want to perform Machine Learning on datasets where the data contains more than a singular integer feature. I can read an array of integers but I will probably want to read arrays of tuples of integers. But I can worry about this later.
</p>
<h1> 13:14 - The state of my browser tabs</h1>
<p>
I currently have 17 solidity-related browser tabs open and because I am not a heathen, this makes me anxious.
</p>
<p>
<img src="https://i.imgur.com/IEriCna.png"></img>
</p>
<h1> 13:15 - Basic machine learning </h1>
<p>
I think I'll take a small break before I start with something small. My plan is to build a linear regression model and train it using gradient descent.
</p>
<h1>13:22 - Getting started</h1>
<p>
Break over. Machine Learning time.
<h1>13:39  - Lunch</h1>
I re-started my break and ate Durhack-provisioned <a href="https://www.subway.com/">Subway</a>. I rate the food quite highly, I was satisfied.
<h1>13:48 - Pain</h1>
It would be really usefuly if solidity had a library for automatic differentiation. It is starting to feel like the language wasn't made for machine learning. I'm taking a break and I will think about my plan moving forward.
<h1>14:02 - Thoughts </h1>
I know from my econometrics book that the OLS estimate for the univariate model, \(Y = \beta_0 + \beta_1 X\) has the following OLS estimate.
</p>
<p>
\[
\begin{align}
\beta_0 &amp;= \bar{X} \\
\beta_1 &amp;= \frac{\text{Cov}(X, Y)}{\text{Var}(X)}
\end{align}
\]
</p>
<p>
For now I will use this shortcut and potentially move onto gradient descent later. There are many similar shortcuts like this since I can use references to find the derivatives for some common loss and activation functions.
</p>
<h1> 14:06 - Pain </h1>
<p>
Solidity does not support floating point numbers. This is disasterous.
</p>
<h1>14:18 - Acceptance</h1>
<p>
I have sped-run the <a href="https://en.wikipedia.org/wiki/Five_stages_of_grief">stages of grief</a> and I am embracing fixed-point arithmetic. What could go wrong.
</p>
<h2> An aside </h2>
<p>
I had an two ideas of re-implementing floating point arithmetic in Solidity or creating a rational number datatype and implementing the arithmetic operations myself. There are also some libraries for floating point arithmetic in Solidity so I am considering potentially using those in the future.
</p>
<h1>14:21 - Disaster</h1>
<p>
Solidity does not actually support fixed-point arithmetic. The language documentation states that fixed-point numbers can be declared but cannot be assigned to. This is horrific.
</p>
<h1>14:24 - Weighing up my options</h1>
<p>
I now have a few options. I can use a hardened and tested library for floating-point arithmetic in Solidity which would make my life easier <i>or</i> I could create a hack to represent rational numbers.
</p>
<p>
\[\dots\]
</p>
<h1>14:25 - Rational numbers</h1>
<p>
So, I can represent a rational number as a pair of integers
</p>
<p>
\[\mathbb Q := \{ (p, q) : p, q \in \mathbb Z \}\]
</p>
<p>
Define equality as the following relation
</p>
<p>
\[ R = \{\left&lt;(p_1, q_1), (p_2, q_2)\right&gt; : p_1 q_2 = q_1 p_2\} \]
</p>
<p>
The reader can verify that this indeed defines an equivalence relation and returns expected results.
</p>
<p>
It is currently 14:31 so I won't spend time formalising my construction but the definition of addition and multiplication comes naturally if you interpret \((p, q)\) as representing the fraction \(\frac{p}{q}\).
</p>
<h1>15:09 - ???</h1>
<p>
I went to test my linear regression code. Loading the values worked fine after I fixed a bug (try and find it in the code above!) but when I ran the code to train the model, the Remix IDE crashed.
</p>
<h1>15:21 - Trying again, minor fixes</h1>
<p>
So I tried running the linear regression with smaller values, the IDE didn't crash and the machine <i>did</i> in fact learn but it had learned the function \(y = 2\) for the data \(X = [1, 2, 3], Y = [3, 5, 8]\). Immediately I was able to spot some minor bugs in my code. There's actually a glaring major mistake in what I wrote above for the OLS estimate for \(\beta_0\). And secondly, I made an subtle error in my training code where I trained a model to predict \(X\) using as the predictor \(X\). There was also another mistake where I calculated the variance wrong and another mistake where I
</p>
<p>
\[\dots\]
</p>
<h1>15:46 - More problems</h1>
<p>
Firstly, the Remix IDE appears to be very prone to crashing. I keep getting the following error.
</p>
<pre>
[21067:1119/154525.567488:ERROR:v8_initializer.cc(714)] V8 javascript OOM (Reached heap limit).
</pre>
<p>
Note that this is almost entirely my fault. My implementation of the Rational numbers is extremely inefficient. And I create new rationals for every operation I complete.
</p>
<h1>15:56 - ...</h1>
<p>
I have sat here poking at my code for 10 minutes and I don't think I can do anything about having the world's worst replacement for floating point numbers. I'm very close to a proof of concept, the smart contract loads the data, trains the model then runs out of memory during the prediction step.
</p>
<h1>16:09 - A terrible mistake</h1>
<p>
I've been calculating the covariance wrong. Just entirely wrong. I tried to make an optimisation but it was just not correct. Essentially I calculated the following
</p>
<p>
\[
\sum_ {i = 1}^ n \frac{(x_i - y_i)^2}{n}
\]
</p>
<p>
I actually want the following
</p>
<p>
\[\sum_ {i=1}^n \frac{(x - \bar{x}_i)(y-\bar{y}_i)}{n}\]
</p>
<h1>16:19 - Success!</h1>
<p>
I gave Buzzword the data (\(X = [1, 2], Y = [2, 4]\)), I then asked it to train the linear regression model. I gave it the value 1 and asked it to predict a result and it returned 2. Nice!
</p>
<p>
I gave it 2 and asked it to predict a result and it returned 4. Cool!
</p>
<p>
I gave it 3 and asked it to predict a result and it returned 6. Awesome!
</p>
<p>
I checked the internals and it has learned the function \(Y = 2X\) or more precisely \(Y = \frac{0}{262144} + \frac{32768}{16384}X\) which computes the same function.
</p>
<p>
Here's my code so far.
</p>
<pre class="lang-solidity pygments" data-lang="solidity">
<span class="k">pragma solidity</span><span class="w"> </span><span class="o">^</span><span class="k">0.8.7</span><span class="p">;</span><span class="w"></span>

<span class="k">contract</span><span class="w"> </span><span class="ni">Buzzword</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span>bytes1<span class="w"> </span><span class="kt">constant</span><span class="w"> </span>ZERO<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span>bytes1<span class="w"> </span><span class="kt">constant</span><span class="w"> </span>NINE<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;9&#39;</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span>xs<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span>ys<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span>work<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="nv">result</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span>Rational<span class="w"> </span>linearRegressionBias<span class="p">;</span><span class="w"></span>
<span class="w">    </span>Rational<span class="w"> </span>linearRegressionWeight<span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="kt">struct</span><span class="w"> </span><span class="nv">Rational</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="nv">p</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="nv">q</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalEquals</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>left<span class="p">,</span><span class="w"> </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>right<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>left<span class="p">.</span>p<span class="w"> </span><span class="o">*</span><span class="w"> </span>right<span class="p">.</span>q<span class="w"> </span><span class="o">==</span><span class="w"> </span>left<span class="p">.</span>q<span class="w"> </span><span class="o">*</span><span class="w"> </span>right<span class="p">.</span>p<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalAdd</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>left<span class="p">,</span><span class="w"> </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>right<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>Rational<span class="p">(</span>left<span class="p">.</span>p<span class="w"> </span><span class="o">*</span><span class="w"> </span>right<span class="p">.</span>q<span class="w"> </span><span class="o">+</span><span class="w"> </span>right<span class="p">.</span>p<span class="w"> </span><span class="o">*</span><span class="w"> </span>left<span class="p">.</span>q<span class="p">,</span><span class="w"> </span>left<span class="p">.</span>q<span class="w"> </span><span class="o">*</span><span class="w"> </span>right<span class="p">.</span>q<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalNegate</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>rational<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>Rational<span class="p">(</span><span class="o">-</span>rational<span class="p">.</span>p<span class="p">,</span><span class="w"> </span>rational<span class="p">.</span>q<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalSubtract</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>left<span class="p">,</span><span class="w"> </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>right<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>rationalAdd<span class="p">(</span>left<span class="p">,</span><span class="w"> </span>rationalNegate<span class="p">(</span>right<span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalMultiply</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>left<span class="p">,</span><span class="w"> </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>right<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>Rational<span class="p">(</span>left<span class="p">.</span>p<span class="w"> </span><span class="o">*</span><span class="w"> </span>right<span class="p">.</span>p<span class="p">,</span><span class="w"> </span>left<span class="p">.</span>q<span class="w"> </span><span class="o">*</span><span class="w"> </span>right<span class="p">.</span>q<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalSquare</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>rational<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>rationalMultiply<span class="p">(</span>rational<span class="p">,</span><span class="w"> </span>rational<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalInvert</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>rational<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>Rational<span class="p">(</span>rational<span class="p">.</span>q<span class="p">,</span><span class="w"> </span>rational<span class="p">.</span>p<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">rationalDivide</span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>left<span class="p">,</span><span class="w"> </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>right<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>rationalMultiply<span class="p">(</span>left<span class="p">,</span><span class="w"> </span>rationalInvert<span class="p">(</span>right<span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">normalise</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>rational<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>Rational<span class="p">(</span>rational<span class="p">.</span>p<span class="w"> </span><span class="o">/</span><span class="w"> </span>rational<span class="p">.</span>q<span class="p">,</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">integerToRational</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="nv">number</span><span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>Rational<span class="p">(</span>number<span class="p">,</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">uintegerToRational</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">number</span><span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>integerToRational<span class="p">(</span><span class="kt">int</span><span class="p">(</span>number<span class="p">));</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">leastSquaresLoss</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="kt">memory</span><span class="w"> </span>yacc<span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="kt">memory</span><span class="w"> </span>yhat<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span>Rational<span class="w"> </span><span class="kt">memory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">require</span><span class="p">(</span>ys<span class="p">.</span>length<span class="w"> </span><span class="o">==</span><span class="w"> </span>yhat<span class="p">.</span>length<span class="p">);</span><span class="w"></span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>n<span class="w"> </span><span class="o">=</span><span class="w"> </span>uintegerToRational<span class="p">(</span>ys<span class="p">.</span>length<span class="p">);</span><span class="w"></span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>loss<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span><span class="m m-Decimal">0</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>index<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>ys<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>index<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>actual<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span>yacc<span class="p">[</span>index<span class="p">]);</span><span class="w"></span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>predicted<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span>yhat<span class="p">[</span>index<span class="p">]);</span><span class="w"></span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>deviation<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalSubtract<span class="p">(</span>actual<span class="p">,</span><span class="w"> </span>predicted<span class="p">);</span><span class="w"></span>
<span class="w">            </span>loss<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalAdd<span class="p">(</span>loss<span class="p">,</span><span class="w"></span>
<span class="w">                </span>rationalDivide<span class="p">(</span><span class="w"></span>
<span class="w">                    </span>rationalSquare<span class="p">(</span>deviation<span class="p">),</span><span class="w"></span>
<span class="w">                    </span>n<span class="w"></span>
<span class="w">                </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>loss<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">trainLinearRegressionModelWithOls</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>Y_bar<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span><span class="m m-Decimal">0</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>X_bar<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span><span class="m m-Decimal">0</span><span class="p">);</span><span class="w"></span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>X_squared_bar<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span><span class="m m-Decimal">0</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>B1<span class="p">;</span><span class="w"></span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>B0<span class="p">;</span><span class="w"></span>

<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>Cov_XY<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span><span class="m m-Decimal">0</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="kt">require</span><span class="p">(</span>xs<span class="p">.</span>length<span class="w"> </span><span class="o">==</span><span class="w"> </span>ys<span class="p">.</span>length<span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Calculate B0 = X_bar</span>
<span class="w">        </span><span class="c1">// And B1 = Cov(X, Y)/Var(X)</span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>n<span class="w"> </span><span class="o">=</span><span class="w"> </span>uintegerToRational<span class="p">(</span>xs<span class="p">.</span>length<span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>index<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>xs<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>index<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Contributing to the mean of X</span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>x<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span>xs<span class="p">[</span>index<span class="p">]);</span><span class="w"></span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>y<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span>ys<span class="p">[</span>index<span class="p">]);</span><span class="w"></span>

<span class="w">            </span>X_squared_bar<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalAdd<span class="p">(</span><span class="w"></span>
<span class="w">                </span>X_squared_bar<span class="p">,</span><span class="w"></span>
<span class="w">                </span>rationalDivide<span class="p">(</span>rationalSquare<span class="p">(</span>x<span class="p">),</span><span class="w"> </span>n<span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">);</span><span class="w"></span>

<span class="w">            </span>X_bar<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalAdd<span class="p">(</span><span class="w"></span>
<span class="w">                </span>X_bar<span class="p">,</span><span class="w"></span>
<span class="w">                </span>rationalDivide<span class="p">(</span>x<span class="p">,</span><span class="w"> </span>n<span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">);</span><span class="w"></span>

<span class="w">            </span>Y_bar<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalAdd<span class="p">(</span><span class="w"></span>
<span class="w">                </span>Y_bar<span class="p">,</span><span class="w"></span>
<span class="w">                </span>rationalDivide<span class="p">(</span>y<span class="p">,</span><span class="w"> </span>n<span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>index<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>xs<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>index<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>x<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span>xs<span class="p">[</span>index<span class="p">]);</span><span class="w"></span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>y<span class="w"> </span><span class="o">=</span><span class="w"> </span>integerToRational<span class="p">(</span>ys<span class="p">[</span>index<span class="p">]);</span><span class="w"></span>
<span class="w">            </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>contribution<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalDivide<span class="p">(</span><span class="w"></span>
<span class="w">                    </span>rationalMultiply<span class="p">(</span><span class="w"></span>
<span class="w">                        </span>rationalSubtract<span class="p">(</span>x<span class="p">,</span><span class="w"> </span>X_bar<span class="p">),</span><span class="w"></span>
<span class="w">                        </span>rationalSubtract<span class="p">(</span>y<span class="p">,</span><span class="w"> </span>Y_bar<span class="p">)</span><span class="w"></span>
<span class="w">                    </span><span class="p">),</span><span class="w"></span>
<span class="w">                    </span>n<span class="w"></span>
<span class="w">                </span><span class="p">);</span><span class="w"></span>
<span class="w">            </span>Cov_XY<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalAdd<span class="p">(</span><span class="w"></span>
<span class="w">                </span>Cov_XY<span class="p">,</span><span class="w"></span>
<span class="w">                </span>contribution<span class="w"></span>
<span class="w">            </span><span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Calculate the variance of X</span>
<span class="w">        </span>Rational<span class="w"> </span><span class="kt">memory</span><span class="w"> </span>Var_X<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalSubtract<span class="p">(</span>X_squared_bar<span class="p">,</span><span class="w"> </span>rationalSquare<span class="p">(</span>X_bar<span class="p">));</span><span class="w"></span>

<span class="w">        </span>B1<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalDivide<span class="p">(</span>Cov_XY<span class="p">,</span><span class="w"> </span>Var_X<span class="p">);</span><span class="w"></span>
<span class="w">        </span>B0<span class="w"> </span><span class="o">=</span><span class="w"> </span>rationalSubtract<span class="p">(</span><span class="w"></span>
<span class="w">            </span>Y_bar<span class="p">,</span><span class="w"></span>
<span class="w">            </span>rationalMultiply<span class="p">(</span>B1<span class="p">,</span><span class="w"> </span>X_bar<span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">);</span><span class="w"></span>

<span class="w">        </span>linearRegressionBias<span class="w"> </span><span class="o">=</span><span class="w"> </span>B0<span class="p">;</span><span class="w"></span>
<span class="w">        </span>linearRegressionWeight<span class="w"> </span><span class="o">=</span><span class="w"> </span>B1<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">predict</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">payable</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span>result<span class="w"> </span><span class="o">=</span><span class="w"> </span>normalise<span class="p">(</span><span class="w"></span>
<span class="w">            </span>rationalAdd<span class="p">(</span><span class="w"></span>
<span class="w">                </span>linearRegressionBias<span class="p">,</span><span class="w"></span>
<span class="w">                </span>rationalMultiply<span class="p">(</span><span class="w"></span>
<span class="w">                    </span>linearRegressionWeight<span class="p">,</span><span class="w"></span>
<span class="w">                    </span>integerToRational<span class="p">(</span>x<span class="p">)</span><span class="w"></span>
<span class="w">                </span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">).</span>p<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">predictionResult</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>result<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">loadData</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>xstring<span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>ystring<span class="p">)</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span><span class="kt">payable</span><span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>xbytes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">bytes</span><span class="p">(</span>xstring<span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>ybytes<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">bytes</span><span class="p">(</span>ystring<span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Work on the assumption that there is at least one item in the arrays</span>
<span class="w">        </span>xs<span class="w"> </span><span class="o">=</span><span class="w"> </span>readIntegerArray<span class="p">(</span>xbytes<span class="p">);</span><span class="w"></span>
<span class="w">        </span>ys<span class="w"> </span><span class="o">=</span><span class="w"> </span>readIntegerArray<span class="p">(</span>ybytes<span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">testXsContainsData</span><span class="p">()</span><span class="w"> </span><span class="kt">public</span><span class="w"> </span>view<span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="kt">return</span><span class="w"> </span>xs<span class="p">[</span><span class="m m-Decimal">0</span><span class="p">];</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="kt">function</span><span class="w"> </span><span class="nv">readIntegerArray</span><span class="p">(</span><span class="kt">bytes</span><span class="w"> </span><span class="nv">memory</span><span class="w"> </span>bArray<span class="p">)</span><span class="w"> </span><span class="kt">private</span><span class="w"> </span><span class="kt">returns</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">[]</span><span class="w"> </span><span class="kt">memory</span><span class="p">){</span><span class="w"></span>
<span class="w">        </span>work<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="kt">int</span><span class="p">[](</span><span class="m m-Decimal">0</span><span class="p">);</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Work out how many numbers there are</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">numIntegers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>index<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>bArray<span class="p">.</span>length<span class="p">;</span><span class="w"> </span>index<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>index<span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>numIntegers<span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="c1">// The beginning of the number begins at</span>
<span class="w">        </span><span class="kt">uint</span><span class="w"> </span><span class="nv">bArrayIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="kt">for</span><span class="w"> </span><span class="p">(</span><span class="kt">uint</span><span class="w"> </span><span class="nv">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">0</span><span class="p">;</span><span class="w"> </span>index<span class="w"> </span><span class="o">&lt;</span><span class="w"> </span>numIntegers<span class="p">;</span><span class="w"> </span>index<span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Read the sign</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="nv">sign</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>bArrayIndex<span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;+&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>sign<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="kt">else</span><span class="w"> </span><span class="kt">if</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>bArrayIndex<span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>sign<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="m m-Decimal">1</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="kt">else</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="kt">require</span><span class="p">(</span><span class="kt">false</span><span class="p">);</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Increment the string index</span>
<span class="w">            </span>bArrayIndex<span class="o">++</span><span class="p">;</span><span class="w"></span>


<span class="w">            </span><span class="kt">uint</span><span class="w"> </span><span class="nv">number</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Read numbers until the termination character</span>
<span class="w">            </span><span class="kt">while</span><span class="w"> </span><span class="p">(</span>bArray<span class="p">[</span>bArrayIndex<span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span>number<span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="m m-Decimal">10</span><span class="p">;</span><span class="w"></span>
<span class="w">                </span>bytes1<span class="w"> </span>digitByte<span class="w"> </span><span class="o">=</span><span class="w"> </span>bArray<span class="p">[</span>bArrayIndex<span class="p">];</span><span class="w"></span>
<span class="w">                </span><span class="kt">require</span><span class="p">(</span>ZERO<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>digitByte<span class="w"> </span><span class="err">&amp;&amp;</span><span class="w"> </span>digitByte<span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span>NINE<span class="p">);</span><span class="w"></span>
<span class="w">                </span><span class="kt">uint8</span><span class="w"> </span><span class="nv">digitValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">uint8</span><span class="p">(</span>digitByte<span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="kt">uint8</span><span class="p">(</span>ZERO<span class="p">);</span><span class="w"></span>
<span class="w">                </span>number<span class="w"> </span><span class="o">+=</span><span class="w"> </span>digitValue<span class="p">;</span><span class="w"></span>
<span class="w">                </span>bArrayIndex<span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="c1">// Skip the final termination symbol</span>
<span class="w">            </span>bArrayIndex<span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="w">            </span>work<span class="p">.</span>push<span class="p">(</span><span class="kt">int</span><span class="p">(</span>number<span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>sign<span class="p">);</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="kt">return</span><span class="w"> </span>work<span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre>
<h1>16:45 - A pretty picture</h1>
<p>
I spent 20 minutes making this graph to explain what Buzzword has done. I am so proud of my creation.
</p>
<p>
<img src="https://i.imgur.com/NA3uWzo.png"/>
</p>
<h1>18:04 - Break over</h1>
<p>
I've just finished an hour break. I'm going to make a promotional webpage.
<h1>18:07 - Another project?</h1>
I found the following [1] blog post a few days ago that used the Salesforce CodeGen model to predict the probability that a specific token follows given the previous sequence of text. The model determined that the probability of the <code>return</code> appearing in the context that it did was low, correctly inferring that there was a bug. This gave me the idea of building a tool like Grammarly but for your code. The author doesn't detail how they did it, but I can work it out.
</p>
<ol>
<li>
<a href="https://joel.tools/codegen/">AI Found a Bug in My Code</a>, <i>Joel Einbinder</i>
</li>
</ol>
<h1>19:17 - A difficulty</h1>
<p>
My measly 24.9GB of RAM and swap is not enough to run the Salesforce Codegen model. This is a problem.
</p>
<h1>19:19 - My options</h1>
<p>
I can either use a smaller model or I can use Google Colab to run computation then export the results to an external application that I'll create. I prefer the latter idea.
</p>
<h1>19:37 - Another idea??</h1>
<p>
I had the idea that I can simulate a <a href="https://en.wikipedia.org/wiki/Turing_machine">Turing machine</a> using GitHub actions with a new commit generated for every step of computation. I like this idea because it is stupid and there is also a prize for the best use of GitHub. I think I'll enter as a contestant.
</p>
<h1>19:44 - GitHub repository created</h1>
<p>
My GitHub repository is live at <a href="https://github.com/dignissimus/github-actions-turing-machine/tree/master">https://github.com/dignissimus/github-actions-turing-machine/</a>
</p>
<h1>19:51 - Deciding on the structure of the project</h1>
<p>
So I want to store the definition of the turing machine somewhere which should be ok. Then I also need to store the state of the turing machine. I left my Theory of Computations books at home but I should be good using Wikipedia as a reference.
</p>
<h1>19:53 - Another realisation</h1>
<p>
I have an assignment for Discrete Maths due in on Monday. I was organised and mostly completed the assignment in advance. But on the final question I used an inductive proof, I haven't shown the base case because it required some manipulation. I will start this sometime soon.
</p>
<h1>22:00 - Slideshow Karaoke</h1>
<p>
I've finished watching Slideshow Karaoke, an awesome event. And I've done my discrete maths as well.
</p>
<h1>22:15 - Project Structure</h1>
<p>
I think I will create a file called <code>state</code> to store the state of the turing machine. To keep things standard, I'll give the Turing machine a binary alphabet (0 and 1) and a single tape for input and output. These choices do not matter for the computational power of the Turing machine.
</p>
<p>
The <code>state</code> file will contain 3 lines.
</p>
<p>
The first line will contain a sequence of 0s 1s. Initially, the tape is filled with 0s. These can be stored implictly.
</p>
<p>
The second line will contain a number, this represents the location of the read-write head on the tape. This number takes on a value from the natural numbers (\(\mathbb N = \{0, 1, 2, \dots\}\)).
</p>
<p>
The third line will again contain a number. This number will index the state that Turing machine is currently in.
</p>
<p>
There will also be a <code>machine</code> file. Each line in this file will define a state for the turing machine. The first line is the starting state.
</p>
<p>
Each state-definition will contain 2 sections. The first section defines the action of the turing machine on input 0. The second section defines the action of the turing machine on input 1.
</p>
<p>
A section defines what the machine outputs, the direction to move the read-write head and the state to transition to.
</p>
<p>
As an example I will give a definition for the 3-state busy beaver champion.
</p>
<h2>State</h2>
<pre>
0
0
0
</pre>
<h2>Machine</h2>
<pre>
1.R.1,1.L.2
1.L.0,1.R.1
1.L.1,1.L.H
</pre>
<p>
In fact, at the start of computation the state file can be initialised to three zeros for any turing machine.
</p>
<h1>22:41 - GitHub actions</h1>
<p>
I don't exactly know how GitHub actions work, but that's ok. I will learn.
</p>
<h1>22:43 - Turing machine status</h1>
<p>
I've decided that I'll create a status file, its value will be <code>running</code>, <code>halt</code> or <code>start</code>. A commit that changes the contents of the status file to <code>start</code> will begin to perform the steps of computation for the Turing machine.
</p>
<h1>23:59 - Midnight Pizza</h1>
<p>
I have been rewarded for my efforts with midnight peperoni pizza. I am happy.
</p>
<h1>01:10 - It works?</h1>
<p>
I was able to start the Turing machine and it correctly performed the first step of computation, but it seems to get stuck and not do anything afterwards.
</p>
<p>
<img src="https://i.imgur.com/O4HyJlY.png"/>
</p>
<p>
To remedy this, I decided to set up a cron schedule to start the action every 5 minutes so it can perform the next step of computation.
</p>
<p>
Will this work? I will find out in 5 minutes.
</p>
<h1>01:25 - Seemingly no progress</h1>
<p>
The cron job does not seem to be running. however, I have another idea. I can run all the commits at once inside the action instead of running each commit in seperate action runs.
</p>
<h1>01:36 - Progress</h1>
<p>
The Turing machine completed <b>three</b> (!) steps before crashing. I am very happy.
<img src="https://i.imgur.com/uw7XDME.png"/>
</p>
<p>
The error message is not that descriptive, it reads as follows
</p>
<pre>
sed: -e expression #1, char 27: Invalid content of \{\}
</pre>
<p>
I'm able to deduce that the line causing the error is the following
</p>
<pre class="lang-bash pygments" data-lang="bash">
<span class="c1"># Replace the character under the read-write head with the output</span>
<span class="c1"># from the state</span>
<span class="nv">NEW_TAPE</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$TAPE</span> <span class="p">|</span> sed -e <span class="s2">&quot;s/\(.\)\{</span><span class="k">$((</span>LOCATION<span class="k">))</span><span class="s2">\}.\(.*\)/\1</span><span class="nv">$OUTPUT</span><span class="s2">\2/&quot;</span><span class="k">)</span>
</pre>
<p>
I've just noticed the problem. You might be able to notice that in the above image, the Turing machine moves one to the right. So now it's in the second cell. Now it moves one to the left, it is back in the first cell. It then moves one to the left - it falls off the grid.
</p>
<h1>01:44 - Definitions</h1>
<p>
I've noticed that the example for the three-state busy beaver champion uses a two-way infinite tape. Hm. When doing Computer Science this doesn't really matter because they are effectively equivalent. But I am not doing Computer Science right now, I am doing Computer Hackery and I am using <code>sed</code> to simulate a Turing machine. This matters a lot.
</p>
<h1>01:48 - A hack</h1>
<p>
I can add a hack that goes like this: If the location of the read write head becomes negative, then I can prepend a character and pretend that the read-write head is at location 0.
</p>
<h1>02:06 - It worked too well</h1>
<p>
So the hack worked - sort of. It worked and kept on going. Then it just kept on going and going and going. The Turing machine just didn't stop. The repository now has 163 commits.
<img src="https://i.imgur.com/7DYzRpX.png"/>
</p>
<h1>02:41 - Tired</h1>
<p>
Oh my god I'm so tired.
</p>
<h1>03:10 - What have I done</h1>
<p>
The machine seems to have started itself while I wasn't paying attention. The repository is now at 954 commits oh god.
</p>
<p>
Was it that cron schedule I wrote a while back?
<img src="https://i.imgur.com/c3hXB12.png"/>
</p>
<h1>03:12</h1>
<p>
We've hit 1,000! I need to turn this off somehow.
<img src="https://i.imgur.com/qqAUSQp.png"/>
</p>
<h1>03:31 - It works!</h1>
<p>
There was some weird and subtle bug with one of my sed rewrite rules. I fixed the bug and the Turing machine works in its entirety! I present to you the three-state busy beaver champion, simulated using GitHub actions and <code>sed</code>.
</p>
<p>
<img src="https://i.imgur.com/UYsCk5O.png"/>
<h1>03:59 - The end</h1>
So I have about 8 hours left for the Hackathon but I think I'll finish here. I've had so much fun at Durhack, my first ever Hackathon.
<img src="https://i.imgur.com/lEsx8ih.png"/>
</p>
        </article>
        
    </body>
</html>
